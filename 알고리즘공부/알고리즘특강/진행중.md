```
#define _CRT_SECURE_NO_WARNINGS
#include<iostream>
#include<string>
#include<string.h>
#include<vector>
using namespace std;

string cc[16] = { "0000","0001","0010","0011","0100","0101","0110","0111",
					"1000","1001","1010","1011","1100","1101","1110","1111" };

char arr[2001][2001];
string bcode;

int codeno[10] = { 3211,2221,2122,1411,1132,1231,1114,1312,1213,3112 };
int answer[8];
int answer_c= 0;
int collect = 0;


void solve(int code_length, int tmp) {

	for (int j = 0; j < tmp; j++) {
//		cout << "j가 시작합ㄴ다" << endl;
//		memset(answer, -1, 8);
		answer_c = 0;
		for (int y = j; y < code_length * 56; y = y + 7 * code_length) {

//			cout << "y : " << y << "         code_length * 56" << code_length * 56 << endl;
//			cout << "y + 7 * code_length : " << y + 7 * code_length << endl;


			int check = 0;
			int cnt = 0;
			int p = 1000;
			int semi = 0;
//			cout << bcode << endl;
			for (int x = y; x < (code_length * 7) + y; x++) {
				cnt++;
				if (bcode[x + 1] - '0' != check) {
					if (cnt % code_length != 0) {////////////
//								cout << "ads" << endl;
//								cout << "break할거임 현재 code_length : " << code_length << "bcode값 : " << x + 1 << endl;
						break;
					}
					semi = semi + (p * (cnt / code_length));
					cnt = 0;
					if (p == 1)
						p = 1000;
					else {
						//								cout << "나눔" << endl;
						p /= 10;
					}

					if (check == 0) {
						check = 1;
					}
					else check = 0;
				}
				else if (bcode[x + 1] == (code_length * 7) + y) {
					semi = semi + (p * (cnt / code_length));
					cnt = 0;
				}
//										cout << semi << endl;
			}
			//					cout << endl;
								////////////////////////////////////////////////////////////4자리수로 변환 끝
				cout << semi << endl;
			for (int x = 0; x < 10; x++) {
				//						cout << "semi : " << semi << endl;
				if (semi == codeno[x]) {
					answer[answer_c] = x;
					answer_c++;
					//							cout << "있다" << endl;
				}
			}

			//					cout << "작은 포문" << endl;


		}
		//					cout << "연산" << endl;
		int odd = answer[0];
		int even = 0;
		for (int x = 1; x < 7; x++) {
			if (x % 2 == 0) { //이게 홀수임
				odd += answer[x];
				//							cout << answer[x] << endl;
			}
			else if (x % 2 == 1) {
				even += answer[x];
				//							cout << answer[x] << endl;
			}

		}
		//			cout << "odd :" << odd << endl << "even : " << even << endl;
		//			cout << (odd * 3) + even + answer[7] << endl;
		if (((odd * 3) + even + answer[7]) % 10 == 0) {
			cout << "!!!!!!!정답!!!!!!!!" << endl;
			cout << bcode << endl;


			for (int j = 0; j < 8; j++) {
				collect += answer[j];
				cout << answer[j] << endl;
			}
			//				cout << collect << endl;
			break;
		}


//		answer_c = 0;
	}

}



void convert(vector<string> v) {

	for (int i = 0; i < v.size(); i++) {
		bcode = "";
		for (int j = 0; j < v[i].length(); j++) {
			if (v[i][j] - '0' >= 0 && v[i][j] - '0' < 10) {
				bcode += cc[v[i][j] - '0'];
			}
			else {
				bcode += cc[v[i][j] - 'A' + 10];
			}
		}
		////////////////////////////////////////////////////////////////////바코드로 변환 끝. 하나씩 하나씩.
		int startno = 4001;
		int endno = -1;

		for (int j = 0; j < bcode.length(); j++) {
			if (bcode[j] - '0' == 1 && startno > j) {
				startno = j;
			}
			else if (bcode[j] - '0' == 1 && endno < j) {
				endno = j;
			}
		}
		////////////////////////////////////////////////////////////0을 제거해주는 작업 시작
		string stmp2 = "";
		for (int j = startno; j <= endno; j++) {
			stmp2 += bcode[j];
		}
		bcode = stmp2;
		/////////////////////////////////////////////////////////////0을 제거해주었음

		int code_length = 1;
		code_length += bcode.length() / 56;

		////////////////////////////////////////////////////////0을 붙여주는 작업 시작

		int tmp;
		tmp = 56 - (bcode.length() % 56);
		stmp2 = "";
		for (int j = 0; j < tmp; j++) {
			stmp2 += "0";
		}
		bcode = stmp2 + bcode + stmp2;
		v[i] = bcode;
//		cout << v[i] << endl;
					/////////////////////////////////////////////////////////0을 붙여주는 작업 끝.
//		cout << "변환 끝" << endl;
		solve(code_length, tmp);
	}
}







int main() {
//	freopen("input.txt", "r", stdin);
	ios_base::sync_with_stdio(false);
	cin.tie(NULL);
	cout.tie(NULL);
	int tc;
	cin >> tc;
	for(int q= 1; q <= tc; q++){
		int border = 2;
		int n, m;
		collect = 0;
		cin >> n >> m;
		string stmp;
		char ctmp;
		vector<string> v;
//		cout << q << endl;
		///////////////////////////////////////////입력파트 시작!!!!/////////////////////////////////
		for (int i = 0; i < n; i++) {
			stmp = "";
			border = 0;
			bool input;
			for (int j = 0; j < m; j++) {
				cin >> ctmp;
				input = true;
				if (ctmp != '0') {
					border = 0;
					stmp += ctmp;
//					cout << stmp << endl;
//					cout << input << endl;
				}
				else if (stmp != "" && ctmp == '0') {
					border++;
				}
//				cout << border << endl;
				if (stmp != "" && ctmp != '0') {
					if (j == m - 1 || j == m - 2) {
						for (int j = 0; j < v.size(); j++) {
							if (stmp == v[j]) {
								input = false;
								stmp = "";
								//							cout << "bream" << endl;
								break;
							}
						}
						if (input) {
							//						cout << "stmp이다 : " << stmp << endl;
							v.push_back(stmp);
							stmp = "";
						}
					}
				}



				if (stmp != "" && border >= 2) {
					for (int j = 0; j < v.size(); j++) {
						if (stmp == v[j]) {
							input = false;
							stmp = "";
//							cout << "bream" << endl;
							break;
						}
					}
					if (input) {
//						cout << "stmp이다 : " << stmp << endl;
						v.push_back(stmp);
						stmp = "";
					}
				}



			}


		}
		
		convert(v); ////////////////////////////////////////////////////0까지 주는 변화작업.













		cout << "#" << q << " " << collect <<  endl;
//		cout << v.size() << endl;
	}
	return 0;
}
```